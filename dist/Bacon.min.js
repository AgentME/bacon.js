(function(){var t,n,r,e,u,i,o,s,c,p,a,f,h,l,y,d,v,g,b,m,S,E,_,w,I,F,x,q,V,O,M,A,D,B,T,N,k,H,L,P,R,W,j,z,U,C,G,J,K,Q,X,Y={}.hasOwnProperty,Z=function(t,n){function r(){this.constructor=t}for(var e in n)Y.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},$=[].slice,tn=function(t,n){return function(){return t.apply(n,arguments)}};t={toString:function(){return"Bacon"}},t.version="<version>",p=("undefined"!=typeof global&&null!==global?global:this).Error,P=function(){},T=function(t,n){return n},V=function(t){return t},S=function(t){return t.slice(0)},A=function(t){return t instanceof Array},B=function(t){return t instanceof l},m={indexOf:Array.prototype.indexOf?function(t,n){return t.indexOf(n)}:function(t,n){var r,e,u,i;for(r=e=0,u=t.length;u>e;r=++e)if(i=t[r],n===i)return r;return-1},indexWhere:function(t,n){var r,e,u,i;for(r=e=0,u=t.length;u>e;r=++e)if(i=t[r],n(i))return r;return-1},head:function(t){return t[0]},always:function(t){return function(){return t}},negate:function(t){return function(n){return!t(n)}},empty:function(t){return 0===t.length},tail:function(t){return t.slice(1,t.length)},filter:function(t,n){var r,e,u,i;for(r=[],e=0,u=n.length;u>e;e++)i=n[e],t(i)&&r.push(i);return r},map:function(t,n){var r,e,u,i;for(u=[],r=0,e=n.length;e>r;r++)i=n[r],u.push(t(i));return u},each:function(t,n){var r,e;for(r in t)e=t[r],n(r,e);return void 0},toArray:function(t){return A(t)?t:[t]},contains:function(t,n){return-1!==m.indexOf(t,n)},id:function(t){return t},last:function(t){return t[t.length-1]},all:function(t,n){var r,e,u;for(null==n&&(n=m.id),r=0,e=t.length;e>r;r++)if(u=t[r],!n(u))return!1;return!0},any:function(t,n){var r,e,u;for(null==n&&(n=m.id),r=0,e=t.length;e>r;r++)if(u=t[r],n(u))return!0;return!1},without:function(t,n){return m.filter(function(n){return n!==t},n)},remove:function(t,n){var r;return r=m.indexOf(n,t),r>=0?n.splice(r,1):void 0},fold:function(t,n,r){var e,u,i;for(e=0,u=t.length;u>e;e++)i=t[e],n=r(n,i);return n},flatMap:function(t,n){return m.fold(n,[],function(n,r){return n.concat(t(r))})},cached:function(t){var n;return n=h,function(){return n===h&&(n=t(),t=void 0),n}},isFunction:function(t){return"function"==typeof t},toString:function(t){var n,r,e,u;try{return W++,null==t?"undefined":m.isFunction(t)?"function":A(t)?W>5?"[..]":"["+m.map(m.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?W>5?"{..}":(r=function(){var r;r=[];for(e in t)Y.call(t,e)&&(u=function(){try{return t[e]}catch(r){return n=r}}(),r.push(m.toString(e)+":"+m.toString(u)));return r}(),"{"+r+"}"):t}finally{W--}}},W=0,t._=m,I=0,s=function(){function t(){this.id=++I}return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}(),f=function(t){function n(t,r){n.__super__.constructor.call(this),!r&&m.isFunction(t)||t instanceof n?(this.valueF=t,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=t)}return Z(n,t),n.prototype.isNext=function(){return!0},n.prototype.hasValue=function(){return!0},n.prototype.value=function(){return this.valueF instanceof n?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0),this.valueInternal},n.prototype.fmap=function(t){var n,r;return this.valueInternal?(r=this.valueInternal,this.apply(function(){return t(r)})):(n=this,this.apply(function(){return t(n.value())}))},n.prototype.apply=function(t){return new n(t)},n.prototype.filter=function(t){return t(this.value())},n.prototype.toString=function(){return m.toString(this.value())},n.prototype.log=function(){return this.value()},n}(s),a=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Z(n,t),n.prototype.isInitial=function(){return!0},n.prototype.isNext=function(){return!1},n.prototype.apply=function(t){return new n(t)},n.prototype.toNext=function(){return new f(this)},n}(f),i=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Z(n,t),n.prototype.isEnd=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<end>"},n}(s),o=function(t){function n(t){this.error=t}return Z(n,t),n.prototype.isError=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<error> "+m.toString(this.error)},n}(s),t.Event=s,t.Initial=a,t.Next=f,t.End=i,t.Error=o,M=function(t){return new a(t,!0)},L=function(t){return new f(t,!0)},w=function(){return new i},U=function(t){return t instanceof s?t:L(t)},t.noMore=["<no-more>"],t.more=["<more>"],b=t.UpdateBarrier=function(){var n,r,e,u,i,o,s,c,p,a,f,h,l,y;return a=void 0,f=[],h={},r=[],e=0,n=function(t){return a?r.push(t):t()},l=function(t,n){var r;return a?(r=h[t.id],null==r?(r=h[t.id]=[n],f.push(t)):r.push(n)):n()},i=function(){for(;f.length>0;)s(0);return void 0},s=function(t){var n,r,e,u,i,s;for(u=f[t],i=u.id,s=h[i],f.splice(t,1),delete h[i],o(u),r=0,e=s.length;e>r;r++)(n=s[r])();return void 0},o=function(t){var n,r,e,u,i;for(r=t.internalDeps(),u=0,i=r.length;i>u;u++)n=r[u],o(n),h[n.id]&&(e=m.indexOf(f,n),s(e));return void 0},p=function(t,n,u,o){var s,c;if(a)return u.apply(n,o);a=t;try{c=u.apply(n,o),i()}finally{for(a=void 0;e<r.length;)s=r[e],e++,s();e=0,r=[]}return c},u=function(){return a?a.id:void 0},y=function(r,e){var u,i,o,s;return s=!1,i=!1,u=function(){return i=!0},o=function(){return s=!0,u()},u=r.dispatcher.subscribe(function(r){return n(function(){var n;return s||(n=e(r),n!==t.noMore)?void 0:o()})}),i&&u(),o},c=function(){return f.length>0},{whenDoneWith:l,hasWaiters:c,inTransaction:p,currentEventId:u,wrappedSubscribe:y,afterTransaction:n}}(),g=function(){function t(t,n,r){this.obs=t,this.sync=n,this.lazy=null!=r?r:!1,this.queue=[]}return t.prototype.subscribe=function(t){return this.obs.dispatcher.subscribe(t)},t.prototype.toString=function(){return this.obs.toString()},t.prototype.markEnded=function(){return this.ended=!0},t.prototype.consume=function(){return this.lazy?{value:m.always(this.queue[0])}:this.queue[0]},t.prototype.push=function(t){return this.queue=[t]},t.prototype.mayHave=function(){return!0},t.prototype.hasAtLeast=function(){return this.queue.length},t.prototype.flatten=!0,t}(),r=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return Z(n,t),n.prototype.consume=function(){return this.queue.shift()},n.prototype.push=function(t){return this.queue.push(t)},n.prototype.mayHave=function(t){return!this.ended||this.queue.length>=t},n.prototype.hasAtLeast=function(t){return this.queue.length>=t},n.prototype.flatten=!1,n}(g),n=function(t){function n(t){n.__super__.constructor.call(this,t,!0)}return Z(n,t),n.prototype.consume=function(){var t;return t=this.queue,this.queue=[],{value:function(){return t}}},n.prototype.push=function(t){return this.queue.push(t.value())},n.prototype.hasAtLeast=function(){return!0},n}(g),g.isTrigger=function(t){return t instanceof g?t.sync:t instanceof c},g.fromObservable=function(t){return t instanceof g?t:t instanceof y?new g(t,!1):new r(t,!0)},e=function(){function t(t,n,r){this.context=t,this.method=n,this.args=r,this.cached=void 0}return t.prototype.deps=function(){return this.cached||(this.cached=x([this.context].concat(this.args)))},t.prototype.apply=function(t){return t.desc=this,t},t.prototype.toString=function(){return m.toString(this.context)+"."+m.toString(this.method)+"("+m.map(m.toString,this.args)+")"},t}(),_=function(){var t,n,r;return n=arguments[0],r=arguments[1],t=3<=arguments.length?$.call(arguments,2):[],(n||r)instanceof e?n||r:new e(n,r,t)},Q=function(){var t,n,r;return t=2<=arguments.length?$.call(arguments,0,n=arguments.length-1):(n=0,[]),r=arguments[n++],_.apply(null,t).apply(r)},x=function(t){return A(t)?m.flatMap(x,t):B(t)?[t]:t instanceof g?[t.obs]:[]},X=function(t){return function(){var n,r,e,u;return e=arguments[0],n=2<=arguments.length?$.call(arguments,1):[],"object"==typeof e&&n.length&&(r=e,u=n[0],e=function(){return r[u].apply(r,arguments)},n=n.slice(1)),t.apply(null,[e].concat($.call(n)))}},k=function(t){return t=Array.prototype.slice.call(t),H.apply(null,t)},R=function(t,n){return function(){var r;return r=1<=arguments.length?$.call(arguments,0):[],t.apply(null,n.concat(r))}},K=function(t){return function(n){return function(r){var e;return null==r?void 0:(e=r[n],m.isFunction(e)?e.apply(r,t):e)}}},C=function(t,n){var r,e;return e=t.slice(1).split("."),r=m.map(K(n),e),function(n){var e,u;for(e=0,u=r.length;u>e;e++)t=r[e],n=t(n);return n}},D=function(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)},H=X(function(){var t,n;return n=arguments[0],t=2<=arguments.length?$.call(arguments,1):[],m.isFunction(n)?t.length?R(n,t):n:D(n)?C(n,t):m.always(n)}),N=function(t,n){return H.apply(null,[t].concat($.call(n)))},E=function(t,n,r,e){var u;return n instanceof y?(u=n.sampledBy(t,function(t,n){return[t,n]}),e.call(u,function(t){var n,r;return n=t[0],r=t[1],n}).map(function(t){var n,r;return n=t[0],r=t[1]})):(n=N(n,r),e.call(t,n))},z=function(t){var n;if(m.isFunction(t))return t;if(D(t))return n=G(t),function(t,r){return t[n](r)};throw new p("not a function or a field key: "+t)},G=function(t){return t.slice(1)},v=function(){function t(t){this.value=t}return t.prototype.getOrElse=function(){return this.value},t.prototype.get=function(){return this.value},t.prototype.filter=function(n){return n(this.value)?new t(this.value):h},t.prototype.map=function(n){return new t(n(this.value))},t.prototype.forEach=function(t){return t(this.value)},t.prototype.isDefined=!0,t.prototype.toArray=function(){return[this.value]},t.prototype.inspect=function(){return"Some("+this.value+")"},t.prototype.toString=function(){return this.inspect()},t}(),h={getOrElse:function(t){return t},filter:function(){return h},map:function(){return h},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}},J=function(t){return t instanceof v||t===h?t:new v(t)},O=0,j=function(){},l=function(){function t(t){this.id=++O,Q(t,this),this.initialDesc=this.desc}return t.prototype.subscribe=function(t){return b.wrappedSubscribe(this,t)},t.prototype.subscribeInternal=function(t){return this.dispatcher.subscribe(t)},t.prototype.onValue=function(){var t;return t=k(arguments),this.subscribe(function(n){return n.hasValue()?t(n.value()):void 0})},t.prototype.onValues=function(t){return this.onValue(function(n){return t.apply(null,n)})},t.prototype.onError=function(){var t;return t=k(arguments),this.subscribe(function(n){return n.isError()?t(n.error):void 0})},t.prototype.onEnd=function(){var t;return t=k(arguments),this.subscribe(function(n){return n.isEnd()?t():void 0})},t.prototype.name=function(t){return this._name=t,this},t.prototype.withDescription=function(){return _.apply(null,arguments).apply(this)},t.prototype.toString=function(){return this._name?this._name:this.desc.toString()},t.prototype.internalDeps=function(){return this.initialDesc.deps()},t}(),l.prototype.assign=l.prototype.onValue,l.prototype.forEach=l.prototype.onValue,l.prototype.inspect=l.prototype.toString,t.Observable=l,u=function(){function n(t,n){this._subscribe=t,this._handleEvent=n,this.subscribe=tn(this.subscribe,this),this.handleEvent=tn(this.handleEvent,this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1,this.prevError=void 0,this.unsubSrc=void 0}return n.prototype.hasSubscribers=function(){return this.subscriptions.length>0},n.prototype.removeSub=function(t){return this.subscriptions=m.without(t,this.subscriptions)},n.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),b.inTransaction(t,this,this.pushIt,[t])},n.prototype.pushToSubscriptions=function(n){var r,e,u,i,o,s;try{for(s=this.subscriptions,e=0,u=s.length;u>e;e++)o=s[e],i=o.sink(n),(i===t.noMore||n.isEnd())&&this.removeSub(o);return!0}catch(c){throw r=c,this.pushing=!1,this.queue=[],r}},n.prototype.pushIt=function(n){if(this.pushing)return this.queue.push(n),t.more;if(n!==this.prevError){for(n.isError()&&(this.prevError=n),this.pushing=!0,this.pushToSubscriptions(n),this.pushing=!1;this.queue.length;)n=this.queue.shift(),this.push(n);return this.hasSubscribers()?t.more:(this.unsubscribeFromSource(),t.noMore)}},n.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},n.prototype.unsubscribeFromSource=function(){return this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},n.prototype.subscribe=function(t){var n;return this.ended?(t(w()),P):(n={sink:t},this.subscriptions.push(n),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent)),function(t){return function(){return t.removeSub(n),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},n}(),c=function(n){function r(t,n,e){m.isFunction(t)&&(e=n,n=t,t=[]),r.__super__.constructor.call(this,t),this.dispatcher=new u(n,e),j(this)}return Z(r,n),r.prototype.toProperty=function(n){var r,e;return e=0===arguments.length?h:J(function(){return n}),r=this.dispatcher,new y(_(this,"toProperty",n),function(n){var u,i,o,s;return u=!1,s=P,i=t.more,o=function(){return u?void 0:e.forEach(function(r){return u=!0,i=n(new a(r)),i===t.noMore?(s(),s=P):void 0})},s=r.subscribe(function(r){return r.hasValue()?u&&r.isInitial()?t.more:(r.isInitial()||o(),u=!0,e=new v(r),n(r)):(r.isEnd()&&(i=o()),i!==t.noMore?n(r):void 0)}),o(),s})},r.prototype.toEventStream=function(){return this},r.prototype.withHandler=function(t){return new r(_(this,"withHandler",t),this.dispatcher.subscribe,t)},r}(l),t.EventStream=c,t.never=function(){return new c(_(t,"never"),function(t){return t(w()),P})},d=function(n){function r(t,n,e){this.property=t,this.subscribe=tn(this.subscribe,this),r.__super__.constructor.call(this,n,e),this.current=h,this.currentValueRootId=void 0,this.propertyEnded=!1}return Z(r,n),r.prototype.push=function(t){return t.isEnd()&&(this.propertyEnded=!0),t.hasValue()&&(this.current=new v(t),this.currentValueRootId=b.currentEventId()),r.__super__.push.call(this,t)},r.prototype.maybeSubSource=function(n,r){return r===t.noMore?P:this.propertyEnded?(n(w()),P):u.prototype.subscribe.call(this,n)},r.prototype.subscribe=function(n){var r,e,u,i;return e=!1,u=t.more,this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)?(r=b.currentEventId(),i=this.currentValueRootId,!this.propertyEnded&&i&&r&&r!==i?(b.whenDoneWith(this.property,function(t){return function(){return t.currentValueRootId===i?n(M(t.current.get().value())):void 0}}(this)),this.maybeSubSource(n,u)):(b.inTransaction(void 0,this,function(){return u=n(M(this.current.get().value()))},[]),this.maybeSubSource(n,u))):this.maybeSubSource(n,u)},r}(u),y=function(t){function n(t,r,e){m.isFunction(t)&&(e=r,r=t,t=[]),n.__super__.constructor.call(this,t),this.dispatcher=new d(this,r,e),j(this)}return Z(n,t),n.prototype.changes=function(){return new c(_(this,"changes"),function(t){return function(n){return t.dispatcher.subscribe(function(t){return t.isInitial()?void 0:n(t)})}}(this))},n.prototype.withHandler=function(t){return new n(_(this,"withHandler",t),this.dispatcher.subscribe,t)},n.prototype.toProperty=function(){return this},n.prototype.toEventStream=function(){return new c(_(this,"toEventStream"),function(t){return function(n){return t.dispatcher.subscribe(function(t){return t.isInitial()&&(t=t.toNext()),n(t)})}}(this))},n}(l),t.Property=y,t.constant=function(n){return new y(_(t,"constant",n),function(t){return t(M(n)),t(w()),P})},t.fromBinder=function(n,r){return null==r&&(r=m.id),new c(_(t,"fromBinder",n,r),function(e){var u,i,o,c;return c=!1,u=!1,i=function(){return c?void 0:"undefined"!=typeof o&&null!==o?(o(),c=!0):u=!0},o=n(function(){var n,u,o,c,p,a;for(n=1<=arguments.length?$.call(arguments,0):[],a=r.apply(this,n),A(a)&&m.last(a)instanceof s||(a=[a]),p=t.more,o=0,c=a.length;c>o;o++)if(u=a[o],p=e(u=U(u)),p===t.noMore||u.isEnd())return i(),p;return p}),u&&i(),i})},F=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"],["bind","unbind"]],q=function(t){var n,r,e,u;for(n=0,r=F.length;r>n;n++)if(u=F[n],e=[t[u[0]],t[u[1]]],e[0]&&e[1])return e;throw new o("No suitable event methods in "+t)},t.fromEventTarget=function(n,r,e){var u,i,o;return u=q(n),i=u[0],o=u[1],Q(t,"fromEvent",n,r,t.fromBinder(function(t){return i.call(n,r,t),function(){return o.call(n,r,t)}},e))},t.fromEvent=t.fromEventTarget,t.Observable.prototype.take=function(n){return 0>=n?t.never():Q(this,"take",n,this.withHandler(function(r){return r.hasValue()?(n--,n>0?this.push(r):(0===n&&this.push(r),this.push(w()),t.noMore)):this.push(r)}))},t.Observable.prototype.first=function(){return Q(this,"first",this.take(1))},"undefined"!=typeof define&&null!==define&&null!=define.amd?(define([],function(){return t}),this.Bacon=t):"undefined"!=typeof module&&null!==module&&null!=module.exports?(module.exports=t,t.Bacon=t):this.Bacon=t}).call(this);