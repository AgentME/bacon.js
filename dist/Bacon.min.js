!function(t,n){"function"==typeof define&&define.amd?define(["exports"],function(r){n(t.Bacon=r)}):n("object"==typeof exports?exports:t)}(this,function(t){"use strict";!function(t){var n=t.polyfill={};n.extends=function(t,n){t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),t.__proto__=n},n.classProps=function(t,n,r){n&&Object.defineProperties(t,n),r&&Object.defineProperties(t.prototype,r)},n.applyConstructor=function(t,n){var r=Object.create(t.prototype),e=t.apply(r,n);return null==e||"object"!=typeof e&&"function"!=typeof e?r:e},n.taggedTemplateLiteral=function(t,n){return Object.defineProperties(t,{raw:{value:n}})},n.interopRequire=function(t){return t&&(t["default"]||t)},n.toArray=function(t){return Array.isArray(t)?t:Array.from(t)},n.objectSpread=function(t,n){var r={};for(var e in t)n.indexOf(e)>=0||Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r},n.hasOwn=Object.prototype.hasOwnProperty,n.slice=Array.prototype.slice}("undefined"==typeof global?self:global);var n,r,e,u,i,o,a,s,l,c,p,h,d,v,y,b,g,m,S,E,w,O,W,x,I,T,j,A,P,k,M,B,F,C,N,V,q,U,D,H;n=function(t){return t["default"]=Object.prototype.hasOwnProperty,t}({}),r=function(t){function n(t){return t instanceof Array}return t["default"]=n,t}({}),e=function(t){function n(t){return"function"==typeof t}return t["default"]=n,t}({}),u=function(t,n,r,e){function u(t){var n,r,e,s;try{return a++,t?f(t)?"function":o(t)?a>5?"[..]":"["+_.map(_.toString,t).toString()+"]":null!=(null!=t?t.toString:void 0)&&t.toString!==Object.prototype.toString?t.toString():"object"==typeof t?a>5?"{..}":(r=function(){var r;r=[];for(e in t)i.call(t,e)&&(s=function(){try{return t[e]}catch(r){return n=r}}(),r.push(u(e)+":"+u(s)));return r}(),"{"+r+"}"):t:"undefined"}finally{a--}}var i=n["default"],o=r["default"],f=e["default"],a=0;return t["default"]=u,t}({},n,r,e),i=function(t){function n(t,n){var r,e,u,i;for(i=[],e=0,u=n.length;u>e;e++)r=n[e],i.push(t(r));return i}return t["default"]=n,t}({}),o=function(t,n,r){var e=n["default"],u=r["default"];return t.map=u,t.toString=e,t}({},u,i),a=function(t){var n=0,r=function(){this.id=++n};return t["default"]=r,t}({}),s=function(t){function n(t,n){var r,e,u;for(r=[],e=0,u=n.length;u>e;e++)t=n[e],f(t)&&r.push(t);return r}return t["default"]=n,t}({}),l=function(t,n){function r(t,n){return e(function(n){return n!==t},n)}var e=n["default"];return t["default"]=r,t}({},s),c=function(t){return t["default"]=(global?global:this).Error,t}({}),p=function(t,n){function r(t,n){if(!n)throw new e(t)}var e=n["default"];return t["default"]=r,t}({},c),h=function(t,n){function r(t){return e("not a function : "+t,isFunction(t))}var e=n["default"];return t["default"]=r,t}({},p),d=function(t){var n=0,r=function(){var t=function(){this.id=++n};return t.prototype.isEvent=function(){return!0},t.prototype.isEnd=function(){return!1},t.prototype.isInitial=function(){return!1},t.prototype.isNext=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.hasValue=function(){return!1},t.prototype.filter=function(){return!0},t.prototype.inspect=function(){return this.toString()},t.prototype.log=function(){return this.toString()},t}();return t["default"]=r,t}({}),v=function(t,n){var r=n["default"],e=function(t){var n=function(){};return polyfill["extends"](n,t),n.prototype.isEnd=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<end>"},n}(r);return t["default"]=e,t}({},d),y=function(t,n){function r(){return new e}var e=n["default"];return t["default"]=r,t}({},v),b=function(t){function n(){}return t["default"]=n,t}({}),g=function(t){return t["default"]=function(){var t,n=[],r={},e=[],u=0;return{afterTransaction:function(n){return t?e.push(n):n()},whenDoneWith:function(e,u){var i;return t?(i=r[e.id],i?i.push(u):(i=r[e.id]=[u],n.push(e))):u()},flush:function(){for(;n.length>0;)flushWaiters(0)},flushWaiters:function(t){var e,u,i,o,f,a;for(u=n[t],i=u.id,o=r[i],n.splice(t,1),delete r[i],flushDepsOf(u),f=0,a=o.length;a>f;f++)(e=o[f])()},flushDepsOf:function(t){var e,u,i,o,f;for(u=t.internalDeps(),o=0,f=u.length;f>o;o++)e=u[o],flushDepsOf(e),r[e.id]&&(i=_.indexOf(n,e),flushWaiters(i))},inTransaction:function(n,r,i,o){var f,a;if(t)return i.apply(r,o);t=n;try{a=i.apply(r,o),flush()}finally{for(t=void 0;u<e.length;)f=e[u],u++,f();u=0,e=[]}return a},currentEventId:function(){return t?t.id:void 0},wrappedSubscribe:function(t,n){var r,e,u;return u=!1,r=function(){},e=function(){return u=!0,r()},r=t.dispatcher.subscribe(function(t){return afterTransaction(function(){var r;return u||(r=n(t),r!==H.noMore)?void 0:e()})}),e},hasWaiters:function(){return n.length>0}}}(),t}({}),m=function(t,n,r,e,u,i){var o=n["default"],f=r["default"],a=e["default"],s=u["default"],l=i["default"],c=function(){var t=function(t,n){this._subscribe=t,this._handleEvent=n,this.subscribe=t.call(this),this.handleEvent=n.call(this),this.subscriptions=[],this.queue=[],this.pushing=!1,this.ended=!1};return t.prototype.hasSubscribers=function(){return this.subscriptions.length>0},t.prototype.removeSub=function(t){this.subscriptions=o(t,this.subscriptions)},t.prototype.push=function(t){return t.isEnd()&&(this.ended=!0),l.inTransaction(t,this,this.pushIt,[t])},t.prototype.pushToSubscriptions=function(t){var n,r,e,u,i,o;try{for(u=this.subscriptions,i=0,o=u.length;o>i;i++)e=u[i],r=e.sink(t),(r===H.noMore||t.isEnd())&&this.removeSub(e);return!0}catch(f){throw n=f,this.pushing=!1,this.queue=[],n}},t.prototype.pushIt=function(t){if(this.pushing)return this.queue.push(t),H.more;if(t!==this.prevError){for(t.isError()&&(this.prevError=t),this.pushing=!0,this.pushToSubscriptions(t),this.pushing=!1;this.queue.length;)t=this.queue.shift(),this.push(t);return this.hasSubscribers()?H.more:(this.unsubscribeFromSource(),H.noMore)}},t.prototype.handleEvent=function(t){return this._handleEvent?this._handleEvent(t):this.push(t)},t.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc(),this.unsubSrc=void 0},t.prototype.subscribe=function(t){var n;return this.ended?(t(a()),s):(f(t),n={sink:t},this.subscriptions.push(n),1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),f(this.unsubSrc)),function(t){return function(){return t.removeSub(n),t.hasSubscribers()?void 0:t.unsubscribeFromSource()}}(this))},t}();return t["default"]=c,t}({},l,h,y,b,g),S=function(t){return t["default"]=[],t}({}),E=function(t,n){function r(t){if(e.length&&!r.running)try{r.running=!0;for(var n,u=e[Symbol.iterator]();!(n=u.next()).done;){var i=n.value;i(t)}}finally{delete r.running}}var e=n["default"];return t["default"]=r,t}({},S),w=function(t,n,r){function e(t){i("not an EventStream : "+t,!(t instanceof u))}var u=n["default"],i=r["default"];return t["default"]=e,t}({},V,p),O=function(t){return t["default"]=Array.prototype.slice,t}({}),W=function(t,n){function r(){var t,n,r;return t=2<=arguments.length?e.call(arguments,0,r=arguments.length-1):(r=0,[]),n=arguments[r++],describe.apply(null,t).apply(n)}var e=n["default"];return t["default"]=r,t}({},O),x=function(t){var n=function(){};return t["default"]=n,t}({}),I=function(t){function n(t){return"string"==typeof t&&t.length>1&&"."===t.charAt(0)}return t["default"]=n,t}({}),T=function(t,n){function r(t){return function(){var n,r,u,i=polyfill.slice.call(arguments);return r=arguments[0],"object"==typeof r&&i.length&&(n=r,u=i[0],r=function(){return n[u].apply(n,arguments)},i=i.slice(1)),t.apply(null,[r].concat(e.call(i)))}}var e=n["default"];return t["default"]=r,t}({},O),j=function(t,n){function r(t,n){return function(){var r=polyfill.slice.call(arguments);return t.apply(null,n.concat(r))}}n["default"];return t["default"]=r,t}({},O),A=function(t,n){function r(t){return function(n){return function(r){var u;return r?(u=r[n],e(u)?u.apply(r,t):u):void 0}}}var e=n["default"];return t["default"]=r,t}({},e),P=function(t,n,r){function e(t,n){var r,e;return e=t.slice(1).split("."),r=u(i(n),e),function(n){var e,u;for(e=0,u=r.length;u>e;e++)t=r[e],n=t(n);return n}}var u=n["default"],i=r["default"];return t["default"]=e,t}({},i,A),k=function(t){function n(t){return function(){return t}}return t["default"]=n,t}({}),M=function(t,n,r,e,u,i,o,f){var a=n["default"],s=r["default"],l=e["default"],c=u["default"],p=i["default"],h=o["default"],d=f["default"];return t["default"]=c(function(){var t,n;return n=arguments[0],t=2<=arguments.length?l.call(arguments,1):[],a(n)?t.length?p(n,t):n:s(n)?h(n,t):d(n)}),t}({},e,I,O,T,j,P,k),B=function(t,n,r){function e(t,n,r,e){var o;n instanceof u?(o=n.sampledBy(t,function(t,n){return[t,n]}),e.call(o,function(t){{var n=polyfill.toArray(t),r=n[0];n[1]}return r}).map(function(t){var n=polyfill.toArray(t),r=(n[0],n[1]);return r})):(n=i(n,r),e.call(t,n))}var u=n["default"],i=r["default"];return t["default"]=e,t}({},x,M),F=function(t){function n(t){return t}return t["default"]=n,t}({}),C=function(t,n,r,e,u){var i=n["default"],o=r["default"],f=e["default"],a=u["default"],o=function(t){var n=function r(n,e){t.call(this),!e&&f(n)||n instanceof r?this.valueF=n:this.valueInternal=n};return polyfill["extends"](n,t),n.prototype.isNext=function(){return!0},n.prototype.hasValue=function(){return!0},n.prototype.value=function(){return this.valueF instanceof n?this.valueInternal=this.valueF.value():this.valueF&&(this.valueInternal=this.valueF()),this.valueInternal},n.prototype.apply=function(t){return new n(t)},n.prototype.filter=function(t){return t(this.value())},n.prototype.toString=function(){return a(this.value())},n.prototype.log=function(){return this.value()},n}(i);return t["default"]=o,t}({},d,C,e,u),N=function(t,n){function r(){return new e}var e=n["default"];return t["default"]=r,t}({},C),V=function(t,n,r,e,u,i,o,f,a,s,l,c){var p=n["default"],h=r["default"],d=e["default"],v=u["default"],y=i["default"],b=o["default"],g=f["default"],m=a["default"],S=(s["default"],l["default"]),E=c["default"],w=function(t){var n=function(n,r,e){v(n)&&(e=r,r=n,n=[]),t.call(this,n),y(r),this.dispatcher=new h(r,e),d(this)};return polyfill["extends"](n,t),n.prototype.delay=function(t){return g(this,"delay",t,this.flatMap(function(n){return H.later(t,n)}))},n.prototype.debounce=function(t){return g(this,"debounce",t,this.flatMapLatest(function(n){return H.later(t,n)}))},n.prototype.debounceImmediate=function(t){return g(this,"debounceImmediate",t,this.flatMapFirst(function(n){return H.once(n).concat(H.later(t).filter(!1))}))},n.prototype.throttle=function(t){return g(this,"throttle",t,this.bufferWithTime(t).map(function(t){return t[t.length-1]}))},n.prototype.bufferWithTime=function(t){return g(this,"bufferWithTime",t,this.bufferWithTimeOrCount(t,Number.MAX_VALUE))},n.prototype.bufferWithCount=function(t){return g(this,"bufferWithCount",t,this.bufferWithTimeOrCount(void 0,t))},n.prototype.bufferWithTimeOrCount=function(t,n){var r;return r=function(r){return r.values.length===n?r.flush():void 0!==t?r.schedule():void 0},g(this,"bufferWithTimeOrCount",t,n,this.buffer(t,r,r))},n.prototype.buffer=function(t,n,r){var e=this;return void 0===n&&(n=S),void 0===r&&(r=S),function(){var u,i,o;return n||(n=S),r||(r=S),u={scheduled:!1,end:void 0,values:[],flush:function(){var t;if(this.scheduled=!1,this.values.length>0){if(t=this.push(E(this.values)),this.values=[],this.end)return this.push(this.end);if(t!==H.noMore)return r(this)}else if(this.end)return this.push(this.end)},schedule:function(){return this.scheduled?void 0:(this.scheduled=!0,t(function(t){return function(){return t.flush()}}(this)))}},o=H.more,v(t)||(i=t,t=function(t){return H.scheduler.setTimeout(t,i)}),g(e,"buffer",e.withHandler(function(t){return u.push=function(t){return function(n){return t.push(n)}}(this),t.isError()?o=this.push(t):t.isEnd()?(u.end=t,u.scheduled||u.flush()):(u.values.push(t.value()),n(u)),o}))}()},n.prototype.merge=function(t){var n;return b(t),n=this,g(n,"merge",t,H.mergeAll(this,t))},n.prototype.toProperty=function(t){var n,r;return r=0===arguments.length?None:toOption(function(){return t}),n=this.dispatcher,new Property(describe(this,"toProperty",t),function(t){var e,u,i,o;return e=!1,o=S,u=H.more,i=function(){return e?void 0:r.forEach(function(n){return e=!0,u=t(new Initial(n)),u===H.noMore?(o(),o=S):void 0})},o=n.subscribe(function(n){return n.hasValue()?e&&n.isInitial()?H.more:(n.isInitial()||i(),e=!0,r=new Some(n),t(n)):(n.isEnd()&&(u=i()),u!==H.noMore?t(n):void 0)}),i(),o})},n.prototype.toEventStream=function(){return this},n.prototype.sampledBy=function(t,n){return g(this,"sampledBy",t,n,this.toProperty().sampledBy(t,n))},n.prototype.concat=function(t){var r;return r=this,new n(describe(r,"concat",t),function(n){var e,u;return u=S,e=r.dispatcher.subscribe(function(r){return r.isEnd()?t.dispatcher.subscribe(n):n(r)}),function(){return e(),u()}})},n.prototype.takeUntil=function(t){var n;return n={},g(this,"takeUntil",t,H.groupSimultaneous(this.mapEnd(n),t.skipErrors()).withHandler(function(r){var e,u,i,o,f,a;if(r.hasValue()){if(a=r.value(),e=a[0],t=a[1],t.length)return this.push(end());for(u=H.more,o=0,f=e.length;f>o;o++)i=e[o],u=this.push(i===n?end():E(i));return u}return this.push(r)}))},n.prototype.skipUntil=function(t){var n;return n=t.take(1).map(!0).toProperty(!1),g(this,"skipUntil",t,this.filter(n))},n.prototype.skipWhile=function(t){var n,r=polyfill.slice.call(arguments,1);return n=!1,m(this,t,r,function(t){return g(this,"skipWhile",t,this.withHandler(function(r){return!n&&r.hasValue()&&t(r.value())?H.more:(r.hasValue()&&(n=!0),this.push(r))}))})},n.prototype.holdWhen=function(t){var n,r,e;return e=t.startWith(!1),r=e.filter(function(t){return!t}),n=e.filter(_.id),g(this,"holdWhen",t,this.filter(!1).merge(e.flatMapConcat(function(t){return function(e){return e?t.scan([],function(t,n){return t.concat(n)}).sampledBy(r).take(1).flatMap(H.fromArray):t.takeUntil(n)}}(this))))},n.prototype.startWith=function(t){g(this,"startWith",t,H.once(t).concat(this))},n.prototype.withHandler=function(t){new n(describe(this,"withHandler",t),this.dispatcher.subscribe,t)},n}(p);return t["default"]=w,t}({},a,m,E,e,h,w,W,B,F,b,N),q=function(t){var n=function(){};return t["default"]=n,t}({}),U=function(t,n){var r=n["default"],e=function(t){var n=function(){};return polyfill["extends"](n,t),n.prototype.isInitial=function(){return!0},n.prototype.isNext=function(){return!1},n.prototype.apply=function(t){return new n(t)},n.prototype.toNext=function(){return new t(this)},n}(r);return t["default"]=e,t}({},C),D=function(t,n,r){var e=n["default"],u=r["default"],i=function(t){var n=function(t){this.error=t};return polyfill["extends"](n,t),n.prototype.isError=function(){return!0},n.prototype.fmap=function(){return this},n.prototype.apply=function(){return this},n.prototype.toString=function(){return"<error> "+u(this.error)},n}(e);return t["default"]=i,t}({},d,u),H=function(t,n){var r=n["default"],e="<version>",u="Bacon";return t.EventStream=EventStream,t.Property=Property,t.Observable=Observable,t.Bus=Bus,t.Initial=Initial,t.Next=Next,t.End=End,t.Error=Error,t.version=e,t.toString=u,t._=r,t}({},o,V,x,a,q,U,v,D),t.Bacon=H});